---
title: "About the Data"
---

## General Information About the Data Set

```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(dplyr)
library(ggplot2)
library(dplyr)
source("raw_data.R")

```

**What are the data dimensions?**

```{r, echo=FALSE, warning=FALSE}
dum<-dim(merged_data)
cat("There are 19 columns and 15674 observations.")
```

**How many families reported their data?**

```{r, echo=FALSE, warning=FALSE}
#Filtered HHMEM==1 
one_person_households <- merged_data %>%
  filter(n_hhmem == 1)
count_one_person_households <- nrow(one_person_households)

cat("There are", count_one_person_households, "reported households that have 1 person.")
```

**What is the average household size?**

```{r, echo=FALSE, warning=FALSE}

household <- merged_data %>%
  group_by(hhid_a) %>%
  summarize(max_n_hnmem = max(n_hhmem, na.rm = TRUE))
average_max_n_hnmem <- mean(household$max_n_hnmem, na.rm = TRUE)
cat("There average house hold size is", average_max_n_hnmem,"people.")

```

**What is the youngest age?**

```{r, echo=FALSE, warning=FALSE}
min_age<-min(merged_data$age_yrs, na.rm = TRUE)
cat("The youngest person in the dataset is", min_age, "years old.")
```

**What is the oldest age?**

```{r, echo=FALSE, warning=FALSE}
max_age<-max(merged_data$age_yrs, na.rm = TRUE)
cat("The oldest person in the dataset is", max_age, "years old.")
```

**What is the distribution of gender?**

```{r, echo=FALSE, warning=FALSE}

ggplot(merged_data, aes(x = factor(male), fill = male)) +
  geom_bar(color = "black", size = 0.7) +  # Specify the border color here
  geom_text(stat = 'count', aes(label = paste0(percent(..count../sum(..count..), accuracy = 0.1))),
            position = position_stack(vjust = 0.5), size = 4, color = "black") +
  labs(title = "Distribution of Gender", x = "Gender", y = "Count") +
  scale_fill_manual(values = c("lightgreen", "lightgrey"), labels = c("Female", "Male"), name = "Gender") +
  theme_minimal() +
  theme(axis.text = element_text(size = 12), axis.title = element_text(size = 14, face = "bold"), plot.title = element_text(size = 16, face = "bold")) +
  labs(fill = "Gender") +
  scale_x_discrete(labels = c("Female", "Male"))
```

The gender distribution indicates that 43.3% of respondents identify as female, 52.4% as male, and 4.3% did not provide a response.

**What is the distribution of household size?**

```{r, echo=FALSE, warning=FALSE}

ggplot(merged_data, aes(x = n_hhmem)) +
  geom_histogram(binwidth = 1, fill = "lightgreen", color = "black") +  # Specify the border color here
  geom_text(stat = 'count', aes(label = paste0(percent(..count../sum(..count..), accuracy = 0.1))),
            position = position_stack(vjust = 0.5), size = 4, color = "black") +
  labs(title = "Distribution of Household Members", x = "Number of Household Members", y = "Count") +
  theme_minimal() +
  theme(axis.text = element_text(size = 12), axis.title = element_text(size = 14, face = "bold"), plot.title = element_text(size = 16, face = "bold")) +
  scale_x_continuous(breaks = seq(min(merged_data$n_hhmem), max(merged_data$n_hhmem), by = 1)) +
  scale_y_continuous(labels = scales::comma_format()) +
  labs(fill = "Number of Household Members in a Household")

```

**What is the race and ethnicity distribution?**

```{r, echo=FALSE, warning=FALSE}
ggplot(merged_data, aes(x = factor(hispanic), fill = factor(hispanic))) +
  geom_bar(color = "black", size = 0.7) +  
  geom_text(stat = 'count', aes(label = paste0(percent(..count../sum(..count..), accuracy = 0.1))),
            position = position_stack(vjust = 0.5), size = 4, color = "black") +
  labs(title = "Distribution of Hispanic Origin", x = "Hispanic Origin", y = "Count") +
  theme_minimal() +
  theme(axis.text = element_text(size = 12), axis.title = element_text(size = 14, face = "bold"), plot.title = element_text(size = 16, face = "bold")) +
  scale_fill_manual(values = c("lightgreen", "lightgrey"), labels = c("Not Hispanic", "Hispanic")) +
  scale_x_discrete(labels = c("Not Hispanic", "Hispanic")) +
  labs(fill = "Legend")
```

**What is the gender distribution?**

```{r, echo=FALSE, warning=FALSE}

merged_data$male <- as.factor(merged_data$male)
gender_counts <- table(merged_data$male)
gender_counts_df <- as.data.frame(gender_counts)
names(gender_counts_df) <- c("Gender", "Count")

ggplot(gender_counts_df, aes(x = Gender, y = Count / sum(Count), fill = Gender)) +
  geom_col(color = "black") +
  geom_text(aes(label = scales::percent(Count / sum(Count), accuracy = 0.1)),
            position = position_stack(vjust = 0.5), size = 4, color = "black") +
  labs(title = "Distribution of Gender", x = "Gender", y = "Proportion") +
  theme_minimal() +
  theme(axis.text = element_text(size = 12), axis.title = element_text(size = 14, face = "bold"), plot.title = element_text(size = 16, face = "bold")) +
  scale_fill_manual(values = c("lightgreen", "lightgrey"), labels = c("Female", "Male")) +
  scale_x_discrete(labels = c("Female", "Male")) + labs(fill = "Legend")
```

**What is the distribution of sexual orientation?**

```{r, echo=FALSE, warning=FALSE}

#maybe do higest to lowest
merged_data$straight <- as.factor(merged_data$straight)
merged_data$gay <- as.factor(merged_data$gay)
merged_data$bisexual <- as.factor(merged_data$bisexual)

sexual_orientation_percentages <- data.frame(
  SexualOrientation = c("Straight", "Gay", "Bisexual"),
  Percentage = c(
    sum(merged_data$straight == "Yes", na.rm = TRUE) / nrow(merged_data) * 100,
    sum(merged_data$gay == "Yes", na.rm = TRUE) / nrow(merged_data) * 100,
    sum(merged_data$bisexual == "Yes", na.rm = TRUE) / nrow(merged_data) * 100
  )
)

ggplot(sexual_orientation_percentages, aes(x = SexualOrientation, y = Percentage, fill = SexualOrientation)) +
  geom_col(color = "black") +
  geom_text(aes(label = paste0(round(Percentage, 1), "%")),
            position = position_stack(vjust = 0.5), size = 4, color = "black") +
  labs(title = "Percentage Distribution of Sexual Orientation", x = "Sexual Orientation", y = "Percentage") +
  theme_minimal() +
  theme(axis.text = element_text(size = 12), axis.title = element_text(size = 14, face = "bold"), plot.title = element_text(size = 16, face = "bold")) +
  scale_fill_manual(values = c("lightgreen", "lightgrey", "darkgreen"),
                    labels = c("Straight", "Gay", "Bisexual")) +
  labs(fill = "Legend")
```

**What is the proportion of substance type?**

```{r, echo=FALSE, warning=FALSE}

#maybe do higest to lowest

merged_data$subsAbuse_type <- as.factor(merged_data$subsAbuse_type)

subsAbuse_percentages <- prop.table(table(merged_data$subsAbuse_type, useNA = "always")) * 100

subsAbuse_df <- as.data.frame(subsAbuse_percentages)
names(subsAbuse_df) <- c("SubstanceAbuse", "Percentage")

ggplot(subsAbuse_df, aes(x = SubstanceAbuse, y = Percentage, fill = SubstanceAbuse)) +
  geom_col(color = "black") +
  geom_text(aes(label = paste0(round(Percentage, 1), "%")),
            position = position_stack(vjust = 0.5), size = 4, color = "black") +
  labs(title = "Percentage Distribution of Substance Abuse Types", x = "Substance Abuse Type", y = "Percentage") +
  theme_minimal() +
  theme(axis.text = element_text(size = 12), axis.title = element_text(size = 14, face = "bold"), plot.title = element_text(size = 16, face = "bold")) +
  scale_fill_manual(values = c("lightgreen", "lightgrey", "darkgrey", "darkgreen", "lightyellow"),
                    labels = levels(merged_data$subsAbuse_type),
                    na.value = "grey") +
  labs(fill = "Legend")
```
